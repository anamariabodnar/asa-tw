<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class Exploits extends CI_Controller {

    private $exploits;
    /**
     * Construct the class and doame Confs.
     */
    function __construct() {
        parent:: __construct();
        $this->load->model('exploit');
        //$this->exploits = array();
        //$this->exploits = $this->exploit->get_exploits();
        //$all_exploits = get_exploits();
    }

  /**
     * Get exploits from csv file that is updated weekly
     */
    function get_exploits_from_csv() {
        global $exploits;
        if (($handle = fopen("C:\\Apache24\\htdocs\\exploitdbAPI\\files.csv", "r")) !== FALSE) {
          while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
              if($data[6]='webapps'){
                $exploit = array('id' => $data[0],
                            'path' => $data[1],
                            'title' => $data[2],
                            'date' => $data[3],
                            'author' => $data[4],
                            'platform' => $data[5]);
                array_push($this->exploits, $exploit);
              }
          }
          fclose($handle);
        }
        return $this->exploits;
    }

	public function index($page=1)
	{
    //global $exploits;
    //$data = array();
    //$data['exploits'] = $exploits;
    $data['exploit_model'] = $this->exploit;
		$this->load->view('pages/exploits', $data);
	}

	public function login_to_continue()
	{
		$this->load->view('pages/login_to_continue');
	}
}
?>